var ImpFolders={getChecked:function(){return this.getFolders().findAll(function(a){return a.checked})},getFolders:function(){return $("fmanager").getInputs(null,"folder_list[]")},selectedFoldersDisplay:function(){var a=0,b="";this.getFolders().each(function(c){if(c.checked){b+=this.displayNames[a]+"\n"}++a});return b.strip()},chooseAction:function(d){var f=(d.element().readAttribute("id")=="action_choose0")?0:1,b=$("action_choose"+f),c=$F(b);b.selectedIndex=0;switch(c){case"create_folder":this.createMailbox();break;case"rebuild_tree":this.submitAction(c);break;default:if(!this.getChecked().size()){if(c!=""){alert(IMP.text.folders_select)}break}switch(c){case"rename_folder":this.renameMailbox();break;case"subscribe_folder":case"unsubscribe_folder":case"poll_folder":case"expunge_folder":case"nopoll_folder":case"mark_folder_seen":case"mark_folder_unseen":case"delete_folder_confirm":case"folders_empty_mailbox_confirm":case"mbox_size":this.submitAction(c);break;case"download_folder":case"download_folder_zip":this.downloadMailbox(c);break;case"import_mbox":if(this.getChecked().length>1){alert(IMP.text.folders_oneselect)}else{this.submitAction(c)}break}break}},submitAction:function(b){$("actionID").setValue(b);$("fmanager").submit()},createMailbox:function(){var a=this.getChecked().size(),b;if(a>1){window.alert(IMP.text.folders_oneselect);return}b=(a==1)?window.prompt(IMP.text.folders_subfolder1+" "+this.selectedFoldersDisplay()+".\n"+IMP.text.folders_subfolder2+"\n",""):window.prompt(IMP.text.folders_toplevel,"");if(b){$("new_mailbox").setValue(b);this.submitAction("create_folder")}},downloadMailbox:function(a){if(window.confirm(IMP.text.folders_download1+"\n"+this.selectedFoldersDisplay()+"\n"+IMP.text.folders_download2)){this.submitAction(a)}},renameMailbox:function(){var b="",c="",a=0;this.getFolders().each(function(e){if(e.checked){if(IMP.conf.fixed_folders.indexOf(this.displayNames[a])!=-1){window.alert(IMP.text.folders_no_rename+" "+this.displayNames[a])}else{var d=window.prompt(IMP.text.folders_rename1+" "+this.displayNames[a]+"\n"+IMP.text.folders_rename2,this.displayNames[a]);if(d){b+=d+"\n";c+=e.value+"\n"}}}++a});if(b){$("new_names").setValue(b.strip());$("old_names").setValue(c.strip());this.submitAction("rename_folder")}},toggleSelection:function(){var c=this.getChecked().size(),a=this.getFolders(),b=(c!=a.size());a.each(function(d){d.checked=b})},changeHandler:function(a){switch(a.element().readAttribute("id")){case"action_choose0":case"action_choose1":this.chooseAction(a);break}},clickHandler:function(a){switch(a.element().readAttribute("id")){case"btn_import":this.submitAction("import_mbox");break;case"btn_return":document.location.href=this.folders_url;break;case"checkAll0":case"checkAll1":this.toggleSelection();break}}};document.observe("change",ImpFolders.changeHandler.bind(ImpFolders));document.observe("click",ImpFolders.clickHandler.bind(ImpFolders));